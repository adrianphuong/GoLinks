{"ast":null,"code":"import React from\"react\";import{useState}from'react';import Repositories from\"./Repositories\";import Pagination from'./Pagination';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[username,setUsername]=useState('');const[repositories,setRepositories]=useState([]);const[descending,setDescending]=useState('desc');const[sortBy,setSortBy]=useState('followers');const[loading,setLoading]=useState(false);const[currentPage,setCurrentPage]=useState(1);const[postsPerPage]=useState(5);const searchRepositories=async()=>{// or const queryString = `q=${query}&sort=${sort}&order=${order}`;\nif(username){setLoading(true);const response=await axios.get('http://localhost:4000/api/searchusers',{params:{q:\"user:\".concat(username),sort:sortBy,order:descending}});const items=response.data.items;//const items = response.data.items.filter(item => item.login.includes(username))\nconst repositoriesWithData=await Promise.all(items.map(async item=>{try{const cachedData=localStorage.getItem(item.login);if(cachedData){return JSON.parse(cachedData);}const repoCountResponse=await axios.get('http://localhost:4000/api/getuserrepos',{params:{repo_url:item.repos_url}});if(repoCountResponse.status===200){const repoCount=repoCountResponse.data.length;const forksCount=repoCountResponse.data.filter(item=>item.forks_count>0).reduce((total,item)=>total+item.forks_count,0);const languages=repoCountResponse.data.filter(item=>item.language);const languageCount={};for(const i of languages){const l=i.language;languageCount[l]=(languageCount[l]||0)+1;}console.log(languageCount);const data={...item,repo_count:repoCount,fork_count:forksCount,languages:languageCount};localStorage.setItem(item.login,JSON.stringify(data));return data;}}catch(error){console.error(\"Error fetching repository count for \".concat(item.login,\":\"),error);return{...item,repo_count:'N/A'};}}));setRepositories(repositoriesWithData);console.log(repositoriesWithData);setLoading(false);}else{setRepositories([]);}};const lastIndex=currentPage*postsPerPage;const startIndex=lastIndex-postsPerPage;let currentPosts=repositories;if(currentPosts.length>lastIndex){currentPosts=repositories.slice(startIndex,lastIndex);}const paginate=number=>setCurrentPage(number);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full bg-neutral-900 h-screen overflow-y-auto\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl text-center m-auto font-bold text-neutral-200 select-none pt-20\",children:\"Learn about your own repositories.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container flex justify-center w-full\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,className:\"w-1/3 border-2 rounded-xl block mt-5 bg-neutral-900 border-neutral-800 p-2 text-neutral-300\",placeholder:\"Search...\",onChange:e=>setUsername(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:searchRepositories,className:\"Search mt-5 px-8 ml-2 block rounded-xl bg-neutral-800 text-neutral-200 hover:bg-neutral-700 transition-all\",children:loading?\"Loading...\":\"Search\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sort-container w-1/3 bg-neutral-900 border-2 border-neutral-800 p-6 m-auto mt-4 rounded-xl flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"m-auto\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-lg text-neutral-400 mr-2\",children:\"Order by:\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setSortBy(e.target.value),className:\"w-40 rounded-md p-1 bg-neutral-800 mr-5 text-neutral-400\",name:\"sortby\",id:\"sortby\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"followers\",children:\"Followers\"}),/*#__PURE__*/_jsx(\"option\",{value:\"repositories\",children:\"Repositories\"}),/*#__PURE__*/_jsx(\"option\",{value:\"joined\",children:\"Join Date\"})]}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setDescending(e.target.value),className:\"w-40 rounded-md p-1 bg-neutral-800 text-neutral-400\",name:\"sort\",id:\"sort\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"desc\",children:\"Descending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"asc\",children:\"Ascending\"})]})]})}),/*#__PURE__*/_jsx(Repositories,{repositories:currentPosts}),/*#__PURE__*/_jsxs(\"h2\",{className:\"results-found w-full text-center mt-3 text-neutral-500\",children:[repositories.length,\" repositories found.\"]}),/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPage,totalPosts:repositories.length,paginate:paginate,currentPage:currentPage})]});}export default App;","map":{"version":3,"names":["React","useState","Repositories","Pagination","axios","jsx","_jsx","jsxs","_jsxs","App","username","setUsername","repositories","setRepositories","descending","setDescending","sortBy","setSortBy","loading","setLoading","currentPage","setCurrentPage","postsPerPage","searchRepositories","response","get","params","q","concat","sort","order","items","data","repositoriesWithData","Promise","all","map","item","cachedData","localStorage","getItem","login","JSON","parse","repoCountResponse","repo_url","repos_url","status","repoCount","length","forksCount","filter","forks_count","reduce","total","languages","language","languageCount","i","l","console","log","repo_count","fork_count","setItem","stringify","error","lastIndex","startIndex","currentPosts","slice","paginate","number","className","children","type","value","placeholder","onChange","e","target","onClick","name","id","totalPosts"],"sources":["/Users/adrianphuong/Desktop/Projects/Practice/GoLinks/frontend/src/App.js"],"sourcesContent":["import React from \"react\";\nimport {useState} from 'react'\nimport Repositories from \"./Repositories\";\nimport Pagination from './Pagination';\nimport axios from 'axios'\n\nfunction App() {\n  const [username, setUsername] = useState('');\n  const [repositories, setRepositories] = useState([]);\n  const[descending, setDescending] = useState('desc')\n  const [sortBy, setSortBy] = useState('followers')\n\n  const [loading, setLoading] = useState(false)\n  const [currentPage, setCurrentPage] = useState(1);\n  const [postsPerPage] = useState(5);\n\n  const searchRepositories = async () => {\n    // or const queryString = `q=${query}&sort=${sort}&order=${order}`;\n    if(username) {\n      setLoading(true)\n\n      const response = await axios.get('http://localhost:4000/api/searchusers', {\n        params: {\n          q: `user:${username}`,\n          sort: sortBy,\n          order: descending\n        }\n      });\n      const items = response.data.items\n      //const items = response.data.items.filter(item => item.login.includes(username))\n      const repositoriesWithData = await Promise.all(items.map(async (item) => {\n        try {\n          const cachedData = localStorage.getItem(item.login);\n          if (cachedData) {\n            return JSON.parse(cachedData);\n          }\n          const repoCountResponse = await axios.get('http://localhost:4000/api/getuserrepos', {\n            params: {\n              repo_url: item.repos_url\n            }\n          });\n          if (repoCountResponse.status === 200) {\n            const repoCount = repoCountResponse.data.length;\n            const forksCount = repoCountResponse.data.filter(item => item.forks_count > 0).reduce((total, item) => total + item.forks_count, 0);\n            const languages = repoCountResponse.data.filter(item => item.language)\n            const languageCount = {}\n            for (const i of languages) {\n              const l = i.language;\n              languageCount[l] = (languageCount[l] || 0) + 1;\n            }\n            console.log(languageCount)\n            const data = { ...item, repo_count: repoCount , fork_count: forksCount, languages: languageCount};\n            localStorage.setItem(item.login, JSON.stringify(data));\n            return data;\n          }\n        } catch (error) {\n          console.error(`Error fetching repository count for ${item.login}:`, error);\n          return { ...item, repo_count: 'N/A' };\n        }\n      }));\n      setRepositories(repositoriesWithData);\n      console.log(repositoriesWithData)\n      setLoading(false)\n    }\n    else {\n      setRepositories([]);\n    }\n  }\n\n  const lastIndex = currentPage * postsPerPage;\n  const startIndex = lastIndex - postsPerPage\n  let currentPosts = repositories\n  if(currentPosts.length > lastIndex) {\n    currentPosts = repositories.slice(startIndex, lastIndex);\n  }\n\n  const paginate = (number) => setCurrentPage(number);\n\n  return (\n    <div className=\"w-full bg-neutral-900 h-screen overflow-y-auto\">\n      <h1 className=\"text-4xl text-center m-auto font-bold text-neutral-200 select-none pt-20\">Learn about your own repositories.</h1>\n      <div className=\"search-container flex justify-center w-full\">\n        <input type = \"text\" value = {username} className=\"w-1/3 border-2 rounded-xl block mt-5 bg-neutral-900 border-neutral-800 p-2 text-neutral-300\" placeholder=\"Search...\" onChange={(e) => setUsername(e.target.value)}></input>\n        <button onClick={searchRepositories}className=\"Search mt-5 px-8 ml-2 block rounded-xl bg-neutral-800 text-neutral-200 hover:bg-neutral-700 transition-all\">{loading ? \"Loading...\" : \"Search\"}</button>\n      </div>\n      <div className=\"sort-container w-1/3 bg-neutral-900 border-2 border-neutral-800 p-6 m-auto mt-4 rounded-xl flex\">\n        <div className=\"m-auto\">\n          <label className=\"text-lg text-neutral-400 mr-2\">Order by:</label>\n          <select onChange={(e) => setSortBy(e.target.value)} className=\"w-40 rounded-md p-1 bg-neutral-800 mr-5 text-neutral-400\" name = \"sortby\" id = \"sortby\">\n            <option value = \"followers\">Followers</option>\n            <option value = \"repositories\">Repositories</option>\n            <option value = \"joined\">Join Date</option>\n          </select>\n          <select onChange={(e) => setDescending(e.target.value)} className=\"w-40 rounded-md p-1 bg-neutral-800 text-neutral-400\" name = \"sort\" id = \"sort\">\n            <option value = \"desc\">Descending</option>\n            <option value = \"asc\">Ascending</option>\n          </select>\n        </div>\n      </div>\n      <Repositories repositories={currentPosts}/>\n      <h2 className=\"results-found w-full text-center mt-3 text-neutral-500\">{repositories.length} repositories found.</h2>\n      <Pagination postsPerPage={postsPerPage} totalPosts={repositories.length} paginate={paginate} currentPage={currentPage}/>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}